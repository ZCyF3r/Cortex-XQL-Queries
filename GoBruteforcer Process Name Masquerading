//GoBruteforcer Process Name Masquerading
//Detects malware masquerading as 'init' process to evade detection
//Based on: https://research.checkpoint.com/2026/inside-gobruteforcer-ai-generated-server-defaults-weak-passwords-and-crypto-focused-campaigns/

config case_sensitive = false timeframe = 7d

| dataset = xdr_data 
| filter event_type = ENUM.PROCESS and event_sub_type = ENUM.PROCESS_START 
| filter action_process_image_name = "init"
| filter action_process_instance_id != "1"
| filter action_process_image_path not contains "/sbin/init" and 
    action_process_image_path not contains "/usr/lib/systemd/systemd"
| alter suspicious_path = if(
    action_process_image_path contains "/tmp/" or
    action_process_image_path contains "/var/tmp/" or
    action_process_image_path contains "/dev/shm/" or
    action_process_image_path contains "/run/lock/", true, false
)
| fields _time, agent_hostname, action_process_image_name, action_process_image_path, actor_effective_username, actor_process_image_name, suspicious_path
