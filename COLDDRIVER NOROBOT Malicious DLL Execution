//COLDDRIVER NOROBOT Malicious DLL Execution
//Detects COLDDRIVER malware loading malicious DLLs via rundll32.exe

config case_sensitive = false timeframe = 30d

| dataset = xdr_data
| filter (
  (event_type = ENUM.PROCESS and event_sub_type = ENUM.PROCESS_START
  and actor_process_image_name contains "rundll32.exe"
  and (actor_process_image_command_line contains "machinerie.dll"
  or actor_process_image_command_line contains "checkme.dll"
  or actor_process_image_command_line contains "iamnotarobot.dll"))
  or
  (event_type = ENUM.LOAD_IMAGE
  and action_module_sha256 in (
  "2e74f6bd9bf73131d3213399ed2f669ec5f75392de69edf8ce8196cd70eb6aee",
  "3b49904b68aedb6031318438ad2ff7be4bf9fd865339330495b177d5c4be69d1",
  "e9c8f6a7dba6e84a7226af89e988ae5e4364e2ff2973c72e14277c0f1462109b",
  "f2da013157c09aec9ceba1d4ac1472ed049833bc878a23bc82fe7eacbad399f4",
  "87138f63974a8ccbbf5840c31165f1a4bf92a954bacccfbf1e7e5525d750aa48"
  ))
)
| fields _time, agent_hostname, actor_effective_username, action_process_image_name, action_process_image_command_line, action_module_path, action_module_sha256
