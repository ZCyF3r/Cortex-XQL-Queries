//Fake ClawdBot VS Code Extension Malware Detection
//Detects known malicious file hashes from weaponized ScreenConnect RAT campaign

config case_sensitive = false timeframe = 30d
| dataset = xdr_data
| filter event_type = ENUM.FILE or event_type = ENUM.PROCESS
| filter action_file_sha256 in (
    "e20b920c7af988aa215c95bbaa365d005dd673544ab7e3577b60fecf11dcdea2",
    "d1e0c26774cb8beabaf64f119652719f673fb530368d5b2166178191ad5fcbea",
    "adbcdb613c04fd51936cb0863d2417604db0cd04792ab7cae02526d48944c77b",
    "04ef48b104d6ebd05ad70f6685ade26c1905495456f52dfe0fb42f550bd43388"
)
| fields _time, actor_effective_username, agent_hostname, agent_ip_address, action_file_name, action_file_path, action_file_sha256, actor_process_image_name, actor_process_command_line, causality_actor_process_image_name, causality_actor_process_command_line
